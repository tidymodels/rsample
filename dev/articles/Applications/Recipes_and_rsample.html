<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rsample">
<title>Recipes with rsample • rsample</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../../deps/Source_Sans_Pro-0.4.5/font.css" rel="stylesheet">
<link href="../../deps/Source_Code_Pro-0.4.5/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Recipes with rsample">
<meta property="og:description" content="rsample">
<meta property="og:image" content="https://rsample.tidymodels.org/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="rsample.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">rsample</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../articles/rsample.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../../articles/Applications/Intervals.html">Bootstrap confidence intervals</a>
    <a class="dropdown-item" href="../../articles/Applications/Recipes_and_rsample.html">Recipes with rsample</a>
    <a class="dropdown-item" href="../../articles/Common_Patterns.html">Common Resampling Patterns</a>
    <a class="dropdown-item" href="../../articles/Working_with_rsets.html">Working with resampling sets</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-learn-more">Learn more</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-learn-more">
    <a class="external-link dropdown-item" href="https://spatialsample.tidymodels.org/">Spatial resampling</a>
    <a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/work/nested-resampling/">Nested resampling</a>
    <a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/time-series/">Time series analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidymodels/rsample/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Recipes with rsample</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/rsample/blob/HEAD/vignettes/Applications/Recipes_and_rsample.Rmd" class="external-link"><code>vignettes/Applications/Recipes_and_rsample.Rmd</code></a></small>
      <div class="d-none name"><code>Recipes_and_rsample.Rmd</code></div>
    </div>

    
    
<p>The <a href="https://recipes.tidymodels.org/" class="external-link">recipes</a> package
contains a data preprocessor that can be used to avoid the potentially
expensive formula methods as well as providing a richer set of data
manipulation tools than base R can provide. This document uses version
1.0.5 of recipes.</p>
<p>In many cases, the preprocessing steps might contain quantities that
require statistical estimation of parameters, such as</p>
<ul>
<li><p>signal extraction using principal component analysis</p></li>
<li><p>imputation of missing values</p></li>
<li><p>transformations of individual variables (e.g. Box-Cox
transformations)</p></li>
</ul>
<p>It is critical that any complex preprocessing steps be contained
<em>inside</em> of resampling so that the model performance estimates
take into account the variability of these steps.</p>
<p>Before discussing how rsample can use recipes, let’s look at an
example recipe for the Ames housing data.</p>
<div class="section level2">
<h2 id="an-example-recipe">An Example Recipe<a class="anchor" aria-label="anchor" href="#an-example-recipe"></a>
</h2>
<p>For illustration, the Ames housing data will be used. There are sale
prices of homes along with various other descriptors for the
property:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ames</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span></span></code></pre></div>
<p>Suppose that we will again fit a simple regression model with the
formula:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Sale_Price</span><span class="op">)</span> <span class="op">~</span> <span class="va">Neighborhood</span> <span class="op">+</span> <span class="va">House_Style</span> <span class="op">+</span> <span class="va">Year_Sold</span> <span class="op">+</span> <span class="va">Lot_Area</span></span></code></pre></div>
<p>The distribution of the lot size is right-skewed:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ames</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Lot_Area</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">5000</span>, col <span class="op">=</span> <span class="st">"red"</span>, fill <span class="op">=</span><span class="st">"red"</span>, alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="Recipes_and_rsample_files/figure-html/build-1.png" alt="The histogram of the lot size, showing a long right tail of the empirical distribution." width="768"></p>
<p>It might benefit the model if we estimate a transformation of the
data using the Box-Cox procedure.</p>
<p>Also, note that the frequencies of the neighborhoods can vary:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ames</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Neighborhood</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="Recipes_and_rsample_files/figure-html/hood-1.png" alt="A bar plot of the counts of different neighborhoods, with the frequencies ranging from over 400 observations of North_Ames to only a handful for Green_Hills and Landmark." width="768"></p>
<p>When these are resampled, some neighborhoods will not be included in
the test set and this will result in a column of dummy variables with
zero entries. The same is true for the <code>House_Style</code>
variable. We might want to collapse rarely occurring values into “other”
categories.</p>
<p>To define the design matrix, an initial recipe is created:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/recipes" class="external-link">recipes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply log10 transformation outside the recipe</span></span>
<span><span class="co"># https://www.tmwr.org/recipes.html#skip-equals-true</span></span>
<span><span class="va">ames</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">ames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Sale_Price <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">Sale_Price</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">Sale_Price</span> <span class="op">~</span> <span class="va">Neighborhood</span> <span class="op">+</span> <span class="va">House_Style</span> <span class="op">+</span> <span class="va">Year_Sold</span> <span class="op">+</span> <span class="va">Lot_Area</span>, </span>
<span>         data <span class="op">=</span> <span class="va">ames</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Collapse rarely occurring jobs into "other"</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_other.html" class="external-link">step_other</a></span><span class="op">(</span><span class="va">Neighborhood</span>, <span class="va">House_Style</span>, threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Dummy variables on the qualitative predictors</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_dummy.html" class="external-link">step_dummy</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_nominal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Unskew a predictor</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_BoxCox.html" class="external-link">step_BoxCox</a></span><span class="op">(</span><span class="va">Lot_Area</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Normalize</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_center.html" class="external-link">step_center</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_scale.html" class="external-link">step_scale</a></span><span class="op">(</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">rec</span></span></code></pre></div>
<p>This recreates the work that the formula method traditionally uses
with the additional steps.</p>
<p>While the original data object <code>ames</code> is used in the call,
it is only used to define the variables and their characteristics so a
single recipe is valid across all resampled versions of the data. The
recipe can be estimated on the analysis component of the resample.</p>
<p>If we execute the recipe on the entire data set:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rec_training_set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="va">rec</span>, training <span class="op">=</span> <span class="va">ames</span><span class="op">)</span></span>
<span><span class="va">rec_training_set</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── Inputs</span></span></code></pre>
<pre><code><span><span class="co">## Number of variables by role</span></span></code></pre>
<pre><code><span><span class="co">## outcome:   1</span></span>
<span><span class="co">## predictor: 4</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── Training information</span></span></code></pre>
<pre><code><span><span class="co">## Training data contained 2930 data points and no incomplete rows.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── Operations</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">Neighborhood</span>, <span style="color: #0000BB;">House_Style</span> | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">Neighborhood</span>, <span style="color: #0000BB;">House_Style</span> | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Box-Cox transformation on: <span style="color: #0000BB;">Lot_Area</span> | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Centering for: <span style="color: #0000BB;">Year_Sold</span>, <span style="color: #0000BB;">Lot_Area</span>, ... | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Scaling for: <span style="color: #0000BB;">Year_Sold</span>, <span style="color: #0000BB;">Lot_Area</span>, ... | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<p>To get the values of the data, the <code>bake</code> function can be
used:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># By default, the selector `everything()` is used to </span></span>
<span><span class="co"># return all the variables. Other selectors can be used too. </span></span>
<span><span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">rec_training_set</span>, new_data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ames</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 14</span></span></span>
<span><span class="co">##   Year_Sold Lot_Area Sale_Price Neighborhood_College_Creek</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      1.68    2.70        5.33                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      1.68    0.506       5.02                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      1.68    0.930       5.24                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>      1.68    0.423       5.39                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>      1.68    0.865       5.28                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>      1.68    0.197       5.29                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 10 more variables: Neighborhood_Old_Town &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Neighborhood_Edwards &lt;dbl&gt;, Neighborhood_Somerset &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Neighborhood_Northridge_Heights &lt;dbl&gt;, Neighborhood_Gilbert &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Neighborhood_Sawyer &lt;dbl&gt;, Neighborhood_other &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   House_Style_One_Story &lt;dbl&gt;, House_Style_Two_Story &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   House_Style_other &lt;dbl&gt;</span></span></span></code></pre>
<p>Note that there are fewer dummy variables for
<code>Neighborhood</code> and <code>House_Style</code> than in the
data.</p>
<p>Also, the above code using <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code> benefits from the
default argument of <code>retain = TRUE</code>, which keeps the
processed version of the data set so that we don’t have to reapply the
steps to extract the processed values. For the data used to train the
recipe, we would have used:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">rec_training_set</span>, new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 14</span></span></span>
<span><span class="co">##   Year_Sold Lot_Area Sale_Price Neighborhood_College_Creek</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>      1.68    2.70        5.33                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>      1.68    0.506       5.02                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>      1.68    0.930       5.24                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>      1.68    0.423       5.39                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>      1.68    0.865       5.28                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>      1.68    0.197       5.29                     -<span style="color: #BB0000;">0.317</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 10 more variables: Neighborhood_Old_Town &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Neighborhood_Edwards &lt;dbl&gt;, Neighborhood_Somerset &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Neighborhood_Northridge_Heights &lt;dbl&gt;, Neighborhood_Gilbert &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   Neighborhood_Sawyer &lt;dbl&gt;, Neighborhood_other &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   House_Style_One_Story &lt;dbl&gt;, House_Style_Two_Story &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   House_Style_other &lt;dbl&gt;</span></span></span></code></pre>
<p>The next section will explore recipes and bootstrap resampling for
modeling:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsample.tidymodels.org">rsample</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7712</span><span class="op">)</span></span>
<span><span class="va">bt_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/bootstraps.html">bootstraps</a></span><span class="op">(</span><span class="va">ames</span><span class="op">)</span></span>
<span><span class="va">bt_samples</span></span></code></pre></div>
<pre><code><span><span class="co">## # Bootstrap sampling </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 25 × 2</span></span></span>
<span><span class="co">##    splits              id         </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;split [2930/1095]&gt;</span> Bootstrap01</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;split [2930/1082]&gt;</span> Bootstrap02</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;split [2930/1072]&gt;</span> Bootstrap03</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;split [2930/1077]&gt;</span> Bootstrap04</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;split [2930/1074]&gt;</span> Bootstrap05</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;split [2930/1088]&gt;</span> Bootstrap06</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;split [2930/1076]&gt;</span> Bootstrap07</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;split [2930/1068]&gt;</span> Bootstrap08</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;split [2930/1062]&gt;</span> Bootstrap09</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;split [2930/1064]&gt;</span> Bootstrap10</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 15 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_samples</span><span class="op">$</span><span class="va">splits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## &lt;Analysis/Assess/Total&gt;</span></span>
<span><span class="co">## &lt;2930/1095/2930&gt;</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="working-with-resamples">Working with Resamples<a class="anchor" aria-label="anchor" href="#working-with-resamples"></a>
</h2>
<p>We can add a recipe column to the tibble. recipes has a convenience
function called <code><a href="https://recipes.tidymodels.org/reference/prepper.html" class="external-link">prepper()</a></code> that can be used to call
<code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code> but has the split object as the first argument (for
easier purrring):</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">bt_samples</span><span class="op">$</span><span class="va">recipes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bt_samples</span><span class="op">$</span><span class="va">splits</span>, <span class="va">prepper</span>, recipe <span class="op">=</span> <span class="va">rec</span><span class="op">)</span></span>
<span><span class="va">bt_samples</span></span></code></pre></div>
<pre><code><span><span class="co">## # Bootstrap sampling </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 25 × 3</span></span></span>
<span><span class="co">##    splits              id          recipes </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;split [2930/1095]&gt;</span> Bootstrap01 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;split [2930/1082]&gt;</span> Bootstrap02 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;split [2930/1072]&gt;</span> Bootstrap03 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;split [2930/1077]&gt;</span> Bootstrap04 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;split [2930/1074]&gt;</span> Bootstrap05 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;split [2930/1088]&gt;</span> Bootstrap06 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;split [2930/1076]&gt;</span> Bootstrap07 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;split [2930/1068]&gt;</span> Bootstrap08 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;split [2930/1062]&gt;</span> Bootstrap09 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;split [2930/1064]&gt;</span> Bootstrap10 <span style="color: #949494;">&lt;recipe&gt;</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 15 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bt_samples</span><span class="op">$</span><span class="va">recipes</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── Inputs</span></span></code></pre>
<pre><code><span><span class="co">## Number of variables by role</span></span></code></pre>
<pre><code><span><span class="co">## outcome:   1</span></span>
<span><span class="co">## predictor: 4</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── Training information</span></span></code></pre>
<pre><code><span><span class="co">## Training data contained 2930 data points and no incomplete rows.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ── Operations</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Collapsing factor levels for: <span style="color: #0000BB;">Neighborhood</span>, <span style="color: #0000BB;">House_Style</span> | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Dummy variables from: <span style="color: #0000BB;">Neighborhood</span>, <span style="color: #0000BB;">House_Style</span> | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Box-Cox transformation on: <span style="color: #0000BB;">Lot_Area</span> | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Centering for: <span style="color: #0000BB;">Year_Sold</span>, <span style="color: #0000BB;">Lot_Area</span>, ... | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">•</span> Scaling for: <span style="color: #0000BB;">Year_Sold</span>, <span style="color: #0000BB;">Lot_Area</span>, ... | <span style="font-style: italic;">Trained</span></span></span></code></pre>
<p>Now, to fit the model, the fit function only needs the recipe as
input. This is because the above code implicitly used the
<code>retain = TRUE</code> option in <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep()</a></code>. Otherwise, the
split objects would also be needed to <code><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake()</a></code> the recipe (as
it will in the prediction function below).</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rec_obj</span>, <span class="va">...</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">...</span>, data <span class="op">=</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">rec_obj</span>, new_data <span class="op">=</span> <span class="cn">NULL</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bt_samples</span><span class="op">$</span><span class="va">lm_mod</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    <span class="va">bt_samples</span><span class="op">$</span><span class="va">recipes</span>, </span>
<span>    <span class="va">fit_lm</span>, </span>
<span>    <span class="va">Sale_Price</span> <span class="op">~</span> <span class="va">.</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">bt_samples</span></span></code></pre></div>
<pre><code><span><span class="co">## # Bootstrap sampling </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 25 × 4</span></span></span>
<span><span class="co">##    splits              id          recipes  lm_mod</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;split [2930/1095]&gt;</span> Bootstrap01 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;split [2930/1082]&gt;</span> Bootstrap02 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;split [2930/1072]&gt;</span> Bootstrap03 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;split [2930/1077]&gt;</span> Bootstrap04 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;split [2930/1074]&gt;</span> Bootstrap05 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;split [2930/1088]&gt;</span> Bootstrap06 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;split [2930/1076]&gt;</span> Bootstrap07 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;split [2930/1068]&gt;</span> Bootstrap08 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;split [2930/1062]&gt;</span> Bootstrap09 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;split [2930/1064]&gt;</span> Bootstrap10 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 15 more rows</span></span></span></code></pre>
<p>To get predictions, the function needs three arguments: the splits
(to get the assessment data), the recipe (to process them), and the
model. To iterate over these, the function <code><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">purrr::pmap()</a></code> is
used:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_lm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">split_obj</span>, <span class="va">rec_obj</span>, <span class="va">model_obj</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mod_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span></span>
<span>    <span class="va">rec_obj</span>, </span>
<span>    new_data <span class="op">=</span> <span class="fu"><a href="../../reference/as.data.frame.rsplit.html">assessment</a></span><span class="op">(</span><span class="va">split_obj</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_outcomes</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">mod_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Sale_Price</span><span class="op">)</span></span>
<span>  <span class="va">out</span><span class="op">$</span><span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model_obj</span>, newdata <span class="op">=</span> <span class="va">mod_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Sale_Price</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bt_samples</span><span class="op">$</span><span class="va">pred</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://tibble.tidyverse.org/reference/lst.html" class="external-link">lst</a></span><span class="op">(</span></span>
<span>      split_obj <span class="op">=</span> <span class="va">bt_samples</span><span class="op">$</span><span class="va">splits</span>, </span>
<span>      rec_obj <span class="op">=</span> <span class="va">bt_samples</span><span class="op">$</span><span class="va">recipes</span>, </span>
<span>      model_obj <span class="op">=</span> <span class="va">bt_samples</span><span class="op">$</span><span class="va">lm_mod</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="va">pred_lm</span> </span>
<span>  <span class="op">)</span></span>
<span><span class="va">bt_samples</span></span></code></pre></div>
<pre><code><span><span class="co">## # Bootstrap sampling </span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 25 × 5</span></span></span>
<span><span class="co">##    splits              id          recipes  lm_mod pred                </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">&lt;split [2930/1095]&gt;</span> Bootstrap01 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,095 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">&lt;split [2930/1082]&gt;</span> Bootstrap02 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,082 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">&lt;split [2930/1072]&gt;</span> Bootstrap03 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,072 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">&lt;split [2930/1077]&gt;</span> Bootstrap04 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,077 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">&lt;split [2930/1074]&gt;</span> Bootstrap05 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,074 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">&lt;split [2930/1088]&gt;</span> Bootstrap06 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,088 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">&lt;split [2930/1076]&gt;</span> Bootstrap07 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,076 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">&lt;split [2930/1068]&gt;</span> Bootstrap08 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,068 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">&lt;split [2930/1062]&gt;</span> Bootstrap09 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,062 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">&lt;split [2930/1064]&gt;</span> Bootstrap10 <span style="color: #949494;">&lt;recipe&gt;</span> <span style="color: #949494;">&lt;lm&gt;</span>   <span style="color: #949494;">&lt;tibble [1,064 × 2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 15 more rows</span></span></span></code></pre>
<p>Calculating the RMSE:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/yardstick" class="external-link">yardstick</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## For binary classification, the first factor level is assumed to be the event.</span></span>
<span><span class="co">## Use the argument `event_level = "second"` to alter this as needed.</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">bt_samples</span><span class="op">$</span><span class="va">pred</span>, <span class="va">rmse</span>, <span class="va">Sale_Price</span>, <span class="va">predicted</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html" class="external-link">list_rbind</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">results</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 25 × 3</span></span></span>
<span><span class="co">##    .metric .estimator .estimate</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> rmse    standard       0.132</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> rmse    standard       0.128</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> rmse    standard       0.129</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> rmse    standard       0.123</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> rmse    standard       0.125</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> rmse    standard       0.140</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> rmse    standard       0.129</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> rmse    standard       0.130</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> rmse    standard       0.122</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> rmse    standard       0.127</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 15 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">.estimate</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.129</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://frick.ws" class="external-link">Hannah Frick</a>, Fanny Chow, <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, Michael Mahoney, <a href="https://juliasilge.com/" class="external-link">Julia Silge</a>, <a href="http://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

  </div></footer>
</body>
</html>
